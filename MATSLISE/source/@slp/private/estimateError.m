function e_loc =estimateError(v)
%@CPM16_14\GET_ERROR
%difference between CPM{18,16} and CPM{16,14}
%used for automatic stepsize selection


eta = [1;1/3;2/30;0.00952380952380952;0.00105820105820106;0.00009620009620010;0.00000740000740001;0.00000049333382667;0.000000029019636863];

v1=v(1);
v2=v(2);
v3=v(3);
v4=v(4);
v5=v(5);
v6=v(6);
v7=v(7);
v8=v(8);
v9=v(9);
v10=v(10);
v11=v(11);
v12=v(12);
v13=v(13);
v14=v(14);
v15=v(15);
v16=v(16);
v77=v7^2;
v66=v6^2;
vv11=v1^2;
v22=v2^2;
v33=v3^2;
v44=v4^2;
v55=v5^2;
vv111=v1^3;
vv12=v1*v2;
vv23=v2*v3;
vv222=v2^3;


% u 
e_u(1)=0;
e_u(2)=-v15/2;
e_u(3)=-1/120*v77+119/2*v15;
e_u(4)=(12012*v77-407386980*v15+60060*v3*v10+60060*v2*v11+...
      60060*v5*v8+30030*v3*v11+30030*v1*v13+30030*v5*v9+...
      60060*v4*v9+60060*v1*v12+60060*v6*v7)/120120;
e_u(5)=(-2072070*v77+85551265800*v15-30810780*v3*v10-35135100*v2*v11-...
      25405380*v5*v8-10810800*v3*v11-15315300*v1*v13-...
      7027020*v5*v9-27567540*v4*v9-40540500*v1*v12-24324300*v6*v7+810*v4^3+...
      5005*v3*v44+9009*v22*v7+15015*vv11*v9+...
      4095*v1*v55+6435*v33*v5+9450*v2*v4*v6+5400*v3*v4*v5+3150*v2*v55+...
      11340*v1*v5*v6+4500*v33*v6+3783780*v6*v8+540540*v2*v12+1801800*v4*v10)/720720;
e_u(6)=(-43243200*vv12*v9-43243200*v1*v3*v8-21621600*vv11*v10-...
      43243200*vv23*v7-43243200*v1*v4*v7+38610*v22*v33+50050*vv11*v44-...
      86486400*v1*v4*v6-86486400*vv23*v6-97297200*v1*v3*v7-86486400*v2*v4*v5-...
      86486400*vv12*v8+5556751200*v77-236121493608000*v15+...
      134918784000*v3*v10+168648480000*v2*v11+102486384000*v5*v8+33405372000*v3*v11+...
      69837768000*v1*v13+14918904000*v5*v9+114162048000*v4*v9+220540320000*v1*v12+...
      97297200000*v6*v7+972000*v4^3-40840800*v3*v44-62702640*v22*v7-111711600*vv11*v9-...
      44226000*v1*v55-52509600*v33*v5+11340000*v2*v4*v6-36763200*v3*v4*v5-...
      17841600*v2*v55-29635200*v1*v5*v6-16221600*v33*v6-11805393600*v6*v8-...
      4410806400*v2*v12-9729720000*v4*v10)/86486400;  
e_u(7)=-31200*v3*v10-82875/2*v2*v11-91575/4*v5*v8-20145/4*v3*v11-...
    6465/4*v5*v9-121125/2*v1*v12-86625/4*v6*v7-4977/8*v77+81904725/2*v15+...
    135/8*vv11*v10-31/3520*v22*v33-277/44352*vv11*v44-23/2464*v1*v3^3-...
    1/96*vv111*v7-3/616*vv222*v4-15/8*v22*v8-1/48*vv111*v6-1/70*vv222*v3+...
    999/40*v22*v7+377/8*vv11*v9+1937/88*v1*v55+969/56*v33*v5+843/286*v2*v55+...
    5469/1144*v33*v6+5355/4*v6*v8+2907/2*v2*v12+7755/4*v4*v10-955/858*v4^3-...
    71/1848*vv12*v3*v4-33915/2*v1*v13+21*vv12*v9+39/2*v1*v3*v8+83/8*vv23*v7+...
    45/4*v1*v4*v7+175/4*v1*v4*v6+327/8*vv23*v6+417/8*v1*v3*v7+297/8*v2*v4*v5+...
    477/8*vv12*v8-227/12320*v1*v22*v5-59/2464*vv11*v3*v5-1/30*vv11*v2*v5-...
    1/35*vv12*v33-1/56*v1*v22*v4-11/336*vv11*v3*v4-965/143*v2*v4*v6+...
    10775/1716*v3*v4*v5+1416/143*v1*v5*v6+395/24*v3*v44-25740*v4*v9;
e_u(8)=-1/2304*v1^4*v3-1/1920*vv111*v22-3/2240*vv111*v2*v3-...
      13/16800*vv11*vv222+13/16*vv111*v6+5/12*vv111*v7+...
      139/80*vv11*v2*v5+23/32*vv11*v2*v6+...
      127/84*vv11*v3*v4+241/352*vv11*v3*v5+841/6336*vv11*v44+...
      1497/1120*v1*v22*v4+201/440*v1*v22*v5+...
      139/112*vv12*v33+61/88*vv12*v3*v4+215/1232*v1*v3^3+...
      85/224*vv222*v3-213/1760*vv222*v4+765/4928*v22*v33-...
      910*vv11*v9-765/2*vv11*v10-...
      2379/2*vv12*v8-1215/4*vv12*v9-...
      7355/8*v1*v3*v7-1095/4*v1*v3*v8-...
      3193/4*v1*v4*v6-297/2*v1*v4*v7-33663/88*v1*v55-24192/143*v1*v5*v6-...
      4059/10*v22*v7+45*v22*v8-555/4*vv23*v4+...
      315/88*vv23*v5-642*vv23*v6-525/8*vv23*v7+245/44*v2*v44-...
      1155/2*v2*v4*v5+83679/1144*v2*v4*v6-7497/572*v2*v55-...
      525/2*v33*v5-48915/1144*v33*v6-740/3*v3*v44-...
      5215/143*v3*v4*v5+14945/1144*v4^3+1526175/2*v1*v12+780045/4*v1*v13+...
      944775/2*v2*v11-20349*v2*v12+686205/2*v3*v10+...
      29070*v3*v11+559845/2*v4*v9-13005*v4*v10+495495/2*v5*v8+6930*v5*v9+...
      467775/2*v6*v7-4725*v6*v8+2079*v77-737142525/2*v15;
  e_u(9)=-1/82944*v1^6+359/16128*v1^4*v3+1/72*v1^4*v4+487/13440*vv111*v22+...
      101/3360*vv111*v2*v3+197/33600*vv11*vv222-11*vv111*v6-611/96*vv111*v7-...
      1713/80*vv11*v2*v5-235/32*vv11*v2*v6-863/48*vv11*v3*v4-2383/352*vv11*v3*v5-...
      18907/6336*vv11*v44-2337/160*v1*v22*v4-2853/1760*v1*v22*v5-105/8*vv12*v33-...
      509/132*vv12*v3*v4-6095/7392*v1*v3^3-797/224*vv222*v3+951/1760*vv222*v4+...
      1219/4928*v22*v33+111605/16*vv11*v9+24225/8*vv11*v10+16575/2*vv12*v8+...
      5865/4*vv12*v9+12493/2*v1*v3*v7+11325/8*v1*v3*v8+21581/4*v1*v4*v6+...
      8841/8*v1*v4*v7+453537/176*v1*v55+27153/26*v1*v5*v6+202059/80*v22*v7-...
      1035/4*v22*v8+15675/4*vv23*v6-885/8*vv23*v7+28035/8*v2*v4*v5-...
      2541/13*v2*v4*v6-35721/572*v2*v55+25185/16*v33*v5+4425/104*v33*v6+...
      70735/48*v3*v44+19845/572*v3*v4*v5-5145/572*v4^3-16380945/4*v1*v12-...
      3900225/4*v1*v13-9258795/4*v2*v11+468027/4*v2*v12-6613425/4*v3*v10-...
      101745/4*v3*v11-5360355/4*v4*v9+33915/4*v4*v10-4729725/4*v5*v8-...
      16065/4*v5*v9-4459455/4*v6*v7+10395/4*v6*v8-9009/8*v77+3053876175/2*v15;
  
%uprime 
e_up(1)=v16/2;
e_up(2)=-(3003*v77+24504480*v16)/360360;
e_up(3)= (-180180*v1*v13-90090*v2*v12-180180*v3*v11-90090*v4*v10-...
    180180*v5*v9-90090*v6*v8-93093*v77+1629547920*v16)/360360;
e_up(4)=-(+15015*vv11*v10-11340*v1*v5*v6+9009*v22*v8-9450*v2*v4*v6+945*v2*v55+1935*v33*v6-...
      5400*v3*v4*v5+4195*v4^3-48828780*v1*v13-29189160*v2*v12-...
      38918880*v3*v11-24684660*v4*v10-...
      34054020*v5*v9-23783760*v6*v8-17099082*v77+136882025280*v16)/720720;
e_up(5)=-7367/8*v77-15385/4*v1*v13+13985/144144*v4^3+483/572*v1*v5*v6+...
     8751/16016*v33*v6-9447/4*v2*v12+879/2288*v2*v55+519/1144*v2*v4*v6-7065/4*v4*v10-...
     6261/4*v6*v8+3183/4004*v3*v4*v5+1/1728*vv11*v44+...
     1/2240*v22*v33+3/4*vv12*v9+3/4*vv23*v7+3/4*v1*v3*v8+3/4*v1*v4*v7+...
     67/48*vv11*v10+9/16*v22*v8-2019/2*v5*v7-7965/4*v5*v9-5055/2*v3*v11+5460315*v16; 
e_up(6)=-109206300*v16-206673/8008*v33*v6+73899*v2*v12-27933/1144*v2*v55+201555/4*v4*v10+...
      84885/2*v6*v8+85/66528*vv11*v44+51/12320*v22*v33-761/12*vv11*v10+...
      3/352*vv222*v4-195/8*v22*v8+5/1232*v1*v3^3+1/48*vv111*v7+...
      199935/4*v5*v9+272445/4*v3*v11+...
      243865/2*v1*v13-193/18480*vv12*v3*v4+180397/8*v77-350345/72072*v4^3+...
      1/3080*v1*v22*v5+9/1232*vv11*v3*v5+11/480*vv11*v2*v6-34201/572*v1*v5*v6-20469/572*v2*v4*v6-...
      1124213/24024*v3*v4*v5-275/4*vv12*v9-213/4*vv23*v7-...
      263/4*v1*v3*v8-59*v1*v4*v7;
e_up(7)=-2847663/8*v77-2306220*v1*v13+251905/1716*v4^3+...
       918837/572*v1*v5*v6+349419/572*v33*v6-5444811/4*v2*v12+338517/572*v2*v55+...
       1198491/1144*v2*v4*v6-3451095/4*v4*v10-2830275/4*v6*v8+1254005/1144*v3*v4*v5+...
       1/2304*v1^4*v4-1037/1386*vv11*v44-7419/12320*v22*v33+4575/2*vv12*v9+...
       5553/4*vv23*v7+8001/4*v1*v3*v8+1685*v1*v4*v7+14645/8*vv11*v10-...
       15263/12320*v1*v22*v5-4273/2464*vv11*v3*v5-2745/1232*vv12*v3*v4-3001/12320*vv222*v4+2823/4*v22*v8-...
       127/308*v1*v3^3-47/48*vv111*v7-3163995/4*v5*v9-4492845/4*v3*v11+...
       1474285050*v16-3/2240*vv111*v2*v3-17/67200*vv11*vv222-111/80*vv11*v2*v6;
e_up(8)=26818407/8*v77+99065715/4*v1*v13-13420435/6864*v4^3-24770781/1144*v1*v5*v6-...
      16948785/2288*v33*v6+28346157/2*v2*v12-16597287/2288*v2*v55-8425515/572*v2*v4*v6+...
      8455035*v4*v10+13680765/2*v6*v8-14952725/1144*v3*v4*v5-13/1152*v1^4*v4-...
      1/82944*v1^6+63451/3168*vv11*v44+7625/616*v22*v33-279675/8*vv12*v9-...
      17655*vv23*v7-55995/2*v1*v3*v8-92849/4*v1*v4*v7-455005/16*vv11*v10+...
      14979/440*v1*v22*v5+7915/176*vv11*v3*v5+236479/3696*vv12*v3*v4+17291/2464*vv222*v4-...
      167535/16*v22*v8+40715/3696*v1*v3^3+1157/48*vv111*v7+29747655/4*v5*v9+42950925/4*v3*v11-...
      12215504700*v16-23/480*vv111*v2*v3-481/33600*vv11*vv222+493/10*vv11*v2*v6;
 e_up(9)=-115954839/8*v77-471927225/4*v1*v13+70743995/6864*v4^3+12676167/104*v1*v5*v6+...
      7685805/208*v33*v6-261627093/4*v2*v12+89707149/2288*v2*v55+8524845/104*v2*v4*v6-...
      148106805/4*v4*v10-118908405/4*v6*v8+75640215/1144*v3*v4*v5+931/2304*v1^4*v4-...
      19/82944*v1^6-1118929/6336*vv11*v44-455831/4928*v22*v33+1692435/8*vv12*v9+...
      94830*vv23*v7+156660*v1*v3*v8+527443/4*v1*v4*v7+2924765/16*vv11*v10-...
      533097/1760*v1*v22*v5-132997/352*vv11*v3*v5-269765/528*vv12*v3*v4-...
      24001/352*vv222*v4+999837/16*v22*v8-35495/462*v1*v3^3-12103/48*vv111*v7-...
      128664585/4*v5*v9-185277645/4*v3*v11+94670161425/2*v16+7867/6720*vv111*v2*v3+...
      31609/67200*vv11*vv222-75161/160*vv11*v2*v6;

% v
% e_v(1)=0;
% e_v(2)=0;
% e_v(3)=-v14/2;
% e_v(4)=(-3465*v66+18378360*v14)/360360;
% e_v(5)=-(-60060*v1*v11-90090*v2*v10-60060*v3*v9-90090*v4*v8-...
%          60060*v5*v7-38115*v66+290990700*v14)/120120;    
% e_v(6)=(15015*vv11*v8+13650*v1*v4*v5+9009*v22*v6+11700*vv23*v5+8905*v2*v44+9945*v33*v4-...
%        32432400*v1*v11-35855820*v2*v10-22882860*v3*v9-25945920*v4*v8-...
%        16936920*v5*v7-10852380*v66+48886437600*v14)/720720;   
% e_v(7)=9177/26*v66-625/1232*v33*v4-155/154*vv23*v5-85/88*v1*v4*v5+...
%          1/3200*v2^4+1/1344*vv11*v33-17/16*vv11*v8-5/4*v1*v3*v6-81/80*v22*v6+633*v5*v7+...
%          1530*v1*v11+3375/4*v3*v9-2340135/2*v14+2655/2*v2*v10-...
%          2857/3696*v2*v44+810*v4*v8;
% e_v(8)=-445347/104*v66+34525/3696*v33*v4+537/22*vv23*v5+...
%          1231/44*v1*v4*v5-89/11200*v2^4-11/672*vv11*v33+...
%          171/4*vv12*v7+455/16*vv11*v8+237/8*v1*v3*v6-31/560*v1*v22*v3-...
%          69/1120*vv11*v2*v4-1/48*vv111*v5+1449/80*v22*v6-8652*v5*v7-24225*v1*v11-22575/2*v3*v9+11700675*v14-...
%         68085/4*v2*v10+2301/176*v2*v44-19725/2*v4*v8;
% e_v(9)=-17/11520*v1^4*v2+17/32*vv111*v5+527/480*vv11*v2*v4+...
%          659/1344*vv11*v33+227/280*v1*v22*v3+1261/22400*v2^4-4615/16*vv11*v8-...
%          1417/4*vv12*v7-273*v1*v3*v6-21469/88*v1*v4*v5-9003/80*v22*v6-...
%          15795/88*vv23*v5-44471/528*v2*v44-39695/528*v33*v4+305235/2*v1*v11+...
%          353685/4*v2*v10+63750*v3*v9+210315/4*v4*v8+94563/2*v5*v7+2379069/104*v66-...
%          105306075/2*v14;

%   vprime
% e_vp(1)=0;
% e_vp(2) =v15/2;
% e_vp(3)=(-3003*v77-21441420*v15)/360360;     
% e_vp(4)=(12012*v77+407386980*v15-60060*v3*v10-...
%           60060*v2*v11-60060*v5*v8+30030*v3*v11+30030*v1*v13+...
%           30030*v5*v9-60060*v4*v9-60060*v1*v12-60060*v6*v7)/120120;  
% e_vp(5)=-1/48*vv11*v9-1/176*v1*v55+9/572*v1*v5*v6-...
%            1/80*v22*v7+15/1144*v2*v4*v6+5/1144*v2*v55-1/112*v33*v5+25/4004*v33*v6-1/144*v3*v44+...
%            15/2002*v3*v4*v5+9/8008*v4^3+225/4*v1*v12-85/4*v1*v13+...
%            +195/4*v2*v11+3/4*v2*v12+171/4*v3*v10-15*v3*v11+...
%            +153/4*v4*v9+5/2*v4*v10+141/4*v5*v8-39/4*v5*v9+135/4*v6*v7+21/4*v6*v8-23/8*v77-...
%            237405/2*v15;    
% e_vp(6)=+1/1728*vv11*v44+1/2240*v22*v33+31/24*vv11*v9-1/4*vv11*v10+...
%           vv12*v8-1/2*vv12*v9+9/8*v1*v3*v7-1/2*v1*v3*v8+v1*v4*v6-1/2*v1*v4*v7+45/88*v1*v55-49/143*v1*v5*v6+...
%           +29/40*v22*+vv23*v6-1/2*vv23*v7+v2*v4*v5+75/572*v2*v4*v6-59/286*v2*v55+17/28*v33*v5-...
%           751/4004*v33*v6+17/36*v3*v44-851/2002*v3*v4*v5+45/4004*v4^3-2550*v1*v12+...
%           1615/2*v1*v13-1950*v2*v11-51*v2*v12-1560*v3*v10+1545/4*v3*v11-1320*v4*v9-225/2*v4*v10-...
%           1185*v5*v8+345/2*v5*v9-1125*v6*v7-273/2*v6*v8+257/4*v77+5460315/2*v15;       
% e_vp(7)=+1/48*vv111*v6-1/96*vv111*v7+1/30*vv11*v2*v5+...
%           11/336*vv11*v3*v4-59/2464*vv11*v3*v5-277/44352*vv11*v44-...
%           +1/56*v1*v22*v4-227/12320*v1*v22*v5+1/35*vv12*v33-...
%           71/1848*vv12*v3*v4-23/2464*v1*v3^3+1/70*vv222*v3-3/616*vv222*v4-...
%           31/3520*v22*v33-377/8*vv11*v9+135/8*vv11*v10-...
%           477/8*vv12*v8+21*vv12*v9-417/8*v1*v3*v7+39/2*v1*v3*v8-...
%           175/4*v1*v4*v6+45/4*v1*v4*v7-1937/88*v1*v55+1416/143*v1*v5*v6-...
%           999/40*v22*v7-15/8*v22*v8-327/8*vv23*v6+83/8*vv23*v7-...
%           297/8*v2*v4*v5-965/143*v2*v4*v6+843/286*v2*v55-...
%           969/56*v33*v5+5469/1144*v33*v6-395/24*v3*v44+10775/1716*v3*v4*v5-...
%           955/858*v4^3+121125/2*v1*v12-33915/2*v1*v13+82875/2*v2*v11+2907/2*v2*v12+...
%           31200*v3*v10-20145/4*v3*v11+25740*v4*v9+7755/4*v4*v10+91575/4*v5*v8-...
%           6465/4*v5*v9+86625/4*v6*v7+5355/4*v6*v8-4977/8*v77-81904725/2*v15;
% e_vp(8)=+1/2304*v1^4*v3+1/1920*vv111*v22-3/2240*vv111*v2*v3-13/16800*vv11*vv222-...
%           13/16*vv111*v6+5/12*vv111*v7-139/80*vv11*v2*v5+23/32*vv11*v2*v6-127/84*vv11*v3*v4+...
%           241/352*vv11*v3*v5+841/6336*vv11*v44-1497/1120*v1*v22*v4+201/440*v1*v22*v5-139/112*vv12*v33+...
%           61/88*vv12*v3*v4+215/1232*v1*v3^3-85/224*vv222*v3-213/1760*vv222*v4+765/4928*v22*v33+...
%           910*vv11*v9-765/2*vv11*v10+2379/2*vv12*v8-1215/4*vv12*v9+...
%           7355/8*v1*v3*v7-1095/4*v1*v3*v8+3193/4*v1*v4*v6-297/2*v1*v4*v7+33663/88*v1*v55-24192/143*v1*v5*v6+...
%           +4059/10*v22*v7+45*v22*v8+642*vv23*v6-525/8*vv23*v7+...
%           1155/2*v2*v4*v5+83679/1144*v2*v4*v6-7497/572*v2*v55+525/2*v33*v5-...
%           48915/1144*v33*v6+740/3*v3*v44-5215/143*v3*v4*v5+14945/1144*v4^3-...
%           1526175/2*v1*v12+780045/4*v1*v13-...
%           944775/2*v2*v11-20349*v2*v12-...
%           686205/2*v3*v10+29070*v3*v11-...
%           559845/2*v4*v9-13005*v4*v10-495495/2*v5*v8+...
%           6930*v5*v9-467775/2*v6*v7-4725*v6*v8+2079*v77+737142525/2*v15;
% e_vp(9)=-1/82944*v1^6-359/16128*v1^4*v3+1/72*v1^4*v4-487/13440*vv111*v22+...
%          101/3360*vv111*v2*v3+197/33600*vv11*vv222+11*vv111*v6-611/96*vv111*v7+...
%          1713/80*vv11*v2*v5-235/32*vv11*v2*v6+863/48*vv11*v3*v4-2383/352*vv11*v3*v5-...
%          18907/6336*vv11*v44+2337/160*v1*v22*v4-2853/1760*v1*v22*v5+105/8*vv12*v33-...
%          509/132*vv12*v3*v4-6095/7392*v1*v3^3+797/224*vv222*v3+951/1760*vv222*v4+...
%          1219/4928*v22*v33-111605/16*vv11*v9+24225/8*vv11*v10-16575/2*vv12*v8+...
%          5865/4*vv12*v9-12493/2*v1*v3*v7+11325/8*v1*v3*v8-21581/4*v1*v4*v6+...
%          8841/8*v1*v4*v7-453537/176*v1*v55+27153/26*v1*v5*v6-202059/80*v22*v7-...
%          1035/4*v22*v8-15675/4*vv23*v6-885/8*vv23*v7-28035/8*v2*v4*v5-...
%          2541/13*v2*v4*v6-35721/572*v2*v55-25185/16*v33*v5+4425/104*v33*v6-...
%          70735/48*v3*v44+19845/572*v3*v4*v5-5145/572*v4^3+16380945/4*v1*v12-...
%          3900225/4*v1*v13+9258795/4*v2*v11+468027/4*v2*v12+6613425/4*v3*v10-...
%          101745/4*v3*v11+5360355/4*v4*v9+33915/4*v4*v10+4729725/4*v5*v8-...
%          16065/4*v5*v9+4459455/4*v6*v7+10395/4*v6*v8-9009/8*v77-3053876175/2*v15;


 % Z(h)=0: collect terms which are additional to the terms to be
 % included in the algorithm CPM{14,8}.
% err_u =  abs(e_u) * eta;
% err_up = abs(e_up) * eta;
% err_v = abs(e_v) * eta;
% err_vp = abs(e_vp) * eta;
err_u =  abs(e_u * eta);
err_up = abs(e_up * eta);
%err_v = abs(e_v * eta)
err_v=0;
%err_vp = abs(e_vp * eta)
err_vp=0;

e_loc0 = max(err_u,max(err_up,max(2*err_v,err_vp)));

%Z(h)~=0: Combining eta's in a form in which Z(h) is factorized, 
% we obtain maxima at different Z(h)-values. Using these maxima, the
% following estimation of the error is obtained.
e_locu = 0.0024*abs(v(15))+2.5e-5*v77+1.8e-5*abs(v3)*abs(v10)+2e-5*abs(v2*v11)+...
    6e-6*abs(v5*v8)+4e-6*abs(v4*v9);
e_locup=0.05*abs(v16)+0.0002*v77+0.0003*abs(v5*v9)+0.0003*abs(v6*v8)+...
    0.0006*abs(v1*v13)+0.0005*abs(v2*v12)+0.0004*abs(v3*v11);    
e_locv=0.0002*abs(v14)+1e-5*v66;
%e_locvp = e_locu;

%e_loc=e_loc0;
e_loc = max(e_loc0,max(e_locu,max(e_locup,e_locv)));


